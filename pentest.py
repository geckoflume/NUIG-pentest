#!/usr/bin/env python3
from datetime import datetime
from os import makedirs, remove
from os.path import dirname, realpath

from tests import *
from tools import leds
from tools.pandoc import Pandoc

Test.interface = "wlan1"
Test.results_path = dirname(realpath(__file__)) + "/results/" + datetime.now().strftime("%Y%m%d_%H%M%S") + "/"
Test.tmp_path = Test.results_path + "tmp/"


def _setup():
    leds.led_mode("green", "heartbeat")
    try:
        makedirs(Test.results_path)
        makedirs(Test.tmp_path)
    except FileExistsError:
        pass
    Ip()


def _run_all():
    Cdp()
    DynamicRouting()
    Fhrp()
    NbtScan()
    Nmap()
    Ping()
    PublicIp()
    Traceroute()
    Wep()
    WifiScan()


def _generate_report():
    Pandoc()


def _clean():
    remove(dirname(realpath(__file__))+"/replay_arp*")
    leds.led_mode("green", "default-on")


_setup()
# _run_all()
Wep()
_generate_report()
_clean()
