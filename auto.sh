#!/bin/bash

generatereport() {
	pandoc $path/*.md -o $path/report_$timestamp.html  --css style.css
	if [[ $? = 0 ]]; then
		echo "Report file successfully generated in $path/report_$timestamp.html"
	else
		echo 'Unable to generate report file'
	fi
	cp style.css $path/
} # generatereport

printstatus() {
	if [[ $? = 0 ]]; then
		echo -e "[\033[0;32m  OK  \033[0m] $@"
	else
		echo -e "[\033[0;31mFAILED\033[0m] $@"
	fi
} # printstatus

./switch_led.sh heartbeat

timestamp=$(date +"%Y%m%d_%H%M%S")
path=results/$timestamp
mkdir -p $path

./icmp.sh $path
printstatus ICMP Test

generatereport

./switch_led.sh default
exit 0
