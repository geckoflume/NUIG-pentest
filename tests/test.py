#!/usr/bin/env python3
from tools.interface import Interface
from tools.leds import led_mode
from tools.report import report


class Test:
    results_path = ''
    tmp_path = ''
    interface = Interface()
    ip = ''
    network = ''

    def __init__(self):
        self.title = ''
        self.desc = ''
        self.vulnerability = ''
        self.exploit = ''
        self.countermeasure = ''
        self.results = ''
        self.filename = ''
        self.code = 0
        led_mode("red", "on")

    def build_report(self):
        report(self.results_path + self.filename, self.title, self.desc, self.vulnerability, self.exploit,
               self.countermeasure, self.results, self.code)

    def end(self):
        led_mode("red", "off")
        if self.code is 0:
            print("[\033[0;32m OK \033[0m] " + self.title)
        else:
            print("[\033[0;31mFAILED\033[0m] " + self.title)
