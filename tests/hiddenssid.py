#!/usr/bin/env python3
from os.path import splitext, basename

from tests.test import Test
from tools.airodump import Airodump

title = 'Hidden SSID decloaking'
desc = 'The board will try discover all SSIDs for detected hidden SSIDs networks ([Wikipedia](' \
       'https://en.wikipedia.org/wiki/Network_cloaking)).'
vulnerability = 'This attack shows the weakest attempt to protect a wireless network, network cloaking.'
exploit = 'A user could use the results to perform all kinds of attacks against the wireless infrastructure. ' \
          'For example, if the board detects the presence of an SSID using PSK (Pre Shared Key) or WEP security, ' \
          'the board can be used to try and crack the PSK or the WEP which would allow the board to decrypt wireless ' \
          'user traffic.'
countermeasure = 'One way to prevent this attack from decloaking your wireless SSID is to use data encryption such ' \
                 'as WPA2 authentication, or to remove the access point from the network.'


class HiddenSsid(Test):
    def __init__(self):
        Test.__init__(self)
        self.title = title
        self.desc = desc
        self.vulnerability = vulnerability
        self.exploit = exploit
        self.countermeasure = countermeasure
        self.filename = splitext(basename(__file__))[0] + ".md"
        self.pre_run()
        self.run()

    def run(self):
        # Monitor mode
        # self.airmon.monitor()
        for t in Airodump.targets_hidden_ssid:
            print(t)
        # Station/managed mode
        # self.airmon.station()

        self.build_report()
        self.end()
