#!/usr/bin/env python3
import os

from tools.util import colon_dash_mac


class Oui:
    def __init__(self):
        self.oui_db = []
        for file in os.listdir("/var/lib/ieee-data/"):
            if ".txt" in file:
                with open("/var/lib/ieee-data/" + file, "r") as ouifile:
                    for line in ouifile:
                        if "(hex)" in line:
                            self.oui_db.append((line[:8], line.split('(hex)')[-1].strip()))

    def find_manufacturer(self, mac):
        oui = colon_dash_mac(mac)
        for res in self.oui_db:
            if oui in res[0]:
                return res[1]
        return ''
