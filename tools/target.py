#!/usr/bin/env python3
from tools.report import Report


class Target:
    template = "{0:17}  {1:2}  {2:4}  {3:3}  {4:10}  {5:10}  {6:2}  {7:32}  {8:50}"

    def __init__(self, fields):
        self.bssid = fields[0]
        self.channel = fields[3]
        self.encryption = fields[5]
        if 'WPA' in self.encryption:
            self.encryption = 'WPA'
            Report.wpa_count += 1
        elif 'WEP' in self.encryption:
            self.encryption = 'WEP'
            Report.wep_count += 1
        self.power = int(fields[8])
        if self.power < 0:
            self.power += 100
        self.beacons = int(fields[9])
        self.ivs = int(fields[10])
        self.essid_len = int(fields[12])
        self.essid = fields[13].strip("\\x00")
        if not self.essid:  # If ESSID is hidden
            self.hidden_essid = True
        else:
            self.hidden_essid = False
        self.decloaked = False  # If ESSID was hidden but we decloaked it.
        self.key = ''
        self.target_ivs_file = ''
        self.clients = []
        self.manufacturer = ''

    # Debug
    def __str__(self):
        ret = Target.template.format(self.bssid, self.channel, self.encryption, str(self.power), str(
            self.beacons), str(self.ivs), str(self.essid_len), self.essid, self.manufacturer) + "\n"
        if self.clients:
            ret += "\tclients:\n"
            for c in self.clients:
                ret += '\t- ' + str(c) + "\n"
            ret += '\n'
        return ret
