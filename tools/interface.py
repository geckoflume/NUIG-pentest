#!/usr/bin/env python3
from subprocess import run, PIPE, DEVNULL


class Interface:
    def __init__(self, name=''):
        self.name = name
        self.exists = False
        self.is_wireless = False
        self.is_connected = False
        self.has_ip = False
        self.wlan_mode = "station"

    def check(self):
        run(["airmon-ng", "stop", self.name + "mon"], stdout=DEVNULL, stderr=DEVNULL)
        ifconfig = run(["ifconfig", self.name], stdout=DEVNULL, stderr=DEVNULL)
        if ifconfig.returncode is 0:  # if interface exists
            self.exists = True
            iwconfig = run(["iwconfig", self.name], stdout=PIPE, stderr=DEVNULL)
            results = iwconfig.stdout.decode()
            if iwconfig.returncode is 0:  # if interface is wireless
                self.is_wireless = True
                for line in results.splitlines():
                    if "ESSID:\"" in line:
                        self.is_connected = True
