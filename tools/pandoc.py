#!/usr/bin/env python3
from subprocess import run, TimeoutExpired, DEVNULL

from tests import Test


class Pandoc(Test):
    def __init__(self):
        Test.__init__(self)
        self.title = "Report file generation"
        self.run()

    def run(self):
        try:
            pandoc = run(
                ["pandoc", "-s", "--toc", "--toc-depth=1", "--css", "style.css", Test.results_path + "*.md", "-o",
                 Test.results_path + "report.html"], stdout=DEVNULL, stderr=DEVNULL, timeout=60)
        except TimeoutExpired:
            self.code = 1
        else:
            self.code = pandoc.returncode
        self.end()
