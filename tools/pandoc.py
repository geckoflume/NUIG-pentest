#!/usr/bin/env python3
from subprocess import run, TimeoutExpired

from tests import Test


class Pandoc(Test):
    def __init__(self):
        Test.__init__(self)
        self.title = "Report file generation"
        self.pre_run()
        self.run()

    def run(self):
        try:
            # pandoc = run(
            #    ["pandoc", "-s", "--toc", "--toc-depth=1", "--css", "style.css", "-o",
            #     Test.results_path + "report.html", Test.results_path + "wep.md"], timeout=60)
            pandoc = run(
                ["pandoc -s --toc --toc-depth=1 --css style.css -o " + Test.results_path +
                 "report.html --from markdown-yaml_metadata_block " + Test.results_path + "*.md"], timeout=60,
                shell=True)
        except TimeoutExpired:
            self.code = 1
        else:
            self.code = pandoc.returncode
        self.end()
